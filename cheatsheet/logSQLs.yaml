# Author: Nuno Aguiar
help:
  text   : "Prints a cheatsheet with tips on how to log all SQLs generated by PostgreSQL"

ojob:
  opacks:
    openaf: 20230704
  logToConsole: true

todo:
- (printmd): |
    # Log PostgreSQL SQLs

    Logging on the PostgreSQL driver is covered on the [PostgreSQL documentation](https://jdbc.postgresql.org/documentation/logging/). In a nutshell you need to 
    find out if the _"-Djava.util.logging.config.file"_ is defined and create or change the corresponding file accordingly.

    ## Logging config file is not set

    If a Java logging properties config file is not set you will need to create one, logging.properties:

    ```
    # Specify the handler, the handlers will be installed during VM startup.
    handlers = java.util.logging.FileHandler

    # Default global logging level.
    .level = OFF

    # Default file output is in user's home directory.
    java.util.logging.FileHandler.pattern = %h/pgjdbc%u.log
    java.util.logging.FileHandler.limit = 5000000
    java.util.logging.FileHandler.count = 20
    java.util.logging.FileHandler.formatter = java.util.logging.SimpleFormatter
    # For XML based formatting you can use:
    # java.util.logging.FileHandler.formatter = java.util.logging.XMLFormatter
    # For JSON based formatting you can use (including the io.github.devatherock/jul-jsonformatter JAR library):
    # java.util.logging.FileHandler.formatter = io.github.devatherock.json.formatter.JSONFormatter
    java.util.logging.FileHandler.level = FINEST

    java.util.logging.SimpleFormatter.format = %1$tY-%1$tm-%1$td %1$tH:%1$tM:%1$tS %4$s %2$s %5$s%6$s%n

    # Facility specific properties.
    org.postgresql.level = FINEST

    ```

    Then you need to start java with the extra _"-Djava.util.logging.config.file=logging.properties"_.
    In OpenAF you just need to set the environment variable **$OAF_JARGS**.

    ---

    ## Logging config file is set

    Then you just need to add:

    ```
    org.postgresql.level=FINEST

    ```

    And the queries will be output to the default logging mechanism. 

    ---

    ## Finding the SQLs

    To find the SQLs on the logs just try to find messages that start with **"sendParse"**